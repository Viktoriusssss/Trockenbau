<Window x:Class="ModernWPFApp.Views.BaustelleEditWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:models="clr-namespace:ModernWPFApp.Models"
        Title="{Binding WindowTitle}"
        Height="900" Width="610"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="{DynamicResource MaterialDesignPaper}"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}">

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" 
                Background="{DynamicResource PrimaryHueLightBrush}"
                CornerRadius="4"
                Padding="16,12"
                Margin="0,0,0,16">
            <StackPanel Orientation="Horizontal">
                <materialDesign:PackIcon Kind="City" 
                                       Width="24" 
                                       Height="24" 
                                       VerticalAlignment="Center"
                                       Foreground="{DynamicResource PrimaryHueMidBrush}"/>
                <TextBlock Text="{Binding WindowTitle}" 
                          FontSize="18" 
                          FontWeight="Medium" 
                          VerticalAlignment="Center"
                          Margin="8,0,0,0"
                          Foreground="{DynamicResource PrimaryHueMidBrush}"/>
            </StackPanel>
        </Border>

        <!-- Form Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Name -->
                <TextBox materialDesign:HintAssist.Hint="Name * (erforderlich)"
                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                         Margin="0,0,0,16"
                         Text="{Binding Baustelle.Name, UpdateSourceTrigger=PropertyChanged}"/>

                <!-- Description -->
                <TextBox materialDesign:HintAssist.Hint="Beschreibung"
                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                         Margin="0,0,0,16"
                         Text="{Binding Baustelle.Beschreibung, UpdateSourceTrigger=PropertyChanged}"
                         AcceptsReturn="True"
                         TextWrapping="Wrap"
                         Height="80"
                         VerticalScrollBarVisibility="Auto"/>

                <!-- Street -->
                <TextBox materialDesign:HintAssist.Hint="StraÃŸe * (erforderlich)"
                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                         Margin="0,0,0,16"
                         Text="{Binding Baustelle.Strasse, UpdateSourceTrigger=PropertyChanged}"/>

                <!-- PLZ and Ort -->
                <Grid Margin="0,0,0,16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="16"/>
                        <ColumnDefinition Width="2*"/>
                    </Grid.ColumnDefinitions>

                    <TextBox Grid.Column="0"
                             materialDesign:HintAssist.Hint="PLZ * (erforderlich)"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Text="{Binding Baustelle.PLZ, UpdateSourceTrigger=PropertyChanged}"/>

                    <TextBox Grid.Column="2"
                             materialDesign:HintAssist.Hint="Ort * (erforderlich)"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Text="{Binding Baustelle.Ort, UpdateSourceTrigger=PropertyChanged}"/>
                </Grid>

                <!-- Customer Selection -->
                <ComboBox materialDesign:HintAssist.Hint="Kunde * (erforderlich)"
                          Style="{StaticResource MaterialDesignOutlinedComboBox}"
                          Margin="0,0,0,16"
                          ItemsSource="{Binding Kunden}"
                          SelectedValue="{Binding Baustelle.KundeId}"
                          SelectedValuePath="Id"
                          DisplayMemberPath="FirmenName"/>

                <!-- Start Date -->
                <DatePicker materialDesign:HintAssist.Hint="Startdatum * (erforderlich)"
                           Style="{StaticResource MaterialDesignOutlinedDatePicker}"
                           Margin="0,0,0,16"
                           SelectedDate="{Binding Baustelle.StartDatum}"/>

                <!-- End Date -->
                <DatePicker materialDesign:HintAssist.Hint="Enddatum (optional)"
                           Style="{StaticResource MaterialDesignOutlinedDatePicker}"
                           Margin="0,0,0,16"
                           SelectedDate="{Binding Baustelle.EndDatum}"/>

                <!-- Status -->
                <ComboBox materialDesign:HintAssist.Hint="Status"
                          Style="{StaticResource MaterialDesignOutlinedComboBox}"
                          Margin="0,0,0,16"
                          SelectedItem="{Binding Baustelle.Status}">
                    <models:BaustellenStatus>Geplant</models:BaustellenStatus>
                    <models:BaustellenStatus>InBearbeitung</models:BaustellenStatus>
                    <models:BaustellenStatus>Pausiert</models:BaustellenStatus>
                    <models:BaustellenStatus>Abgeschlossen</models:BaustellenStatus>
                    <models:BaustellenStatus>Storniert</models:BaustellenStatus>
                </ComboBox>

                

                <!-- Error Message -->
                <TextBlock Text="{Binding ErrorMessage}"
                          Foreground="Red"
                          TextWrapping="Wrap"
                          Margin="0,0,0,16"
                          Visibility="{Binding ErrorMessage, Converter={StaticResource StringToVisibilityConverter}}"/>
            </StackPanel>
        </ScrollViewer>

        <!-- Buttons -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right" 
                    Margin="0,16,0,0">
            <Button Content="ABBRECHEN"
                    Style="{StaticResource MaterialDesignOutlinedButton}"
                    Command="{Binding CancelCommand}"
                    Margin="0,0,8,0"/>
            <Button Content="SPEICHERN"
                    Style="{StaticResource MaterialDesignRaisedButton}"
                    Command="{Binding SaveCommand}"
                    IsEnabled="{Binding IsValid}"/>
        </StackPanel>
    </Grid>
</Window>
